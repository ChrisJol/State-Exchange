<html>

<head>
    <title>New Post!</title>
    <link rel='stylesheet' href='stylesheets/global.css'>
</head>

<div id="app">

    <div class="layout-header">
        <div class="layout-body">
            <div class="topper">
                <a href="index"><h1 class="topper__title">State Exchange</h1></a>
                    <form class="topper__form" v-on:submit.prevent="sendQuery">
                        <input type="text" placeholder="Search" class="topper__form--input" v-model="query">
                        <button type="submit" class="topper__form--button">GO</button>
                    </form>
                <div class="topper__links">
                    <a href="#" class="topper__links--login">Login</a>
                    <a href="#" class="topper__links--signup">Signup</a>
                </div>
                <div class="nav">
                    <a href="index" class="nav__item">Home</a>
                    <a href="about" class="nav__item">About</a>
                    <a href="#" class="nav__item">For Sale</a>
                    <a href="newpost" class="nav__item">New Post</a>
                    <a href="dashboard" class="nav__item">Dashboard</a>
                </div>
            </div>
        </div>
    </div>

    <div class="layout-body">
        <h1>Create a New Post</h1>
        <form class="form newpost grid" method="POST">
            <label for="title" class="form__label grid__col--1">Title</label>
            <input v-model='title' id= "title" type="input" class="title form__input--border grid__col--8">
            <label class="grid__col--3 form__input--border" for="addImage">Add Image</label>
            <input accept="image/*" id="addImage" type="file" class="form__image-input grid__col--3"></input>
            <label for="desc" class="form__label grid__col--1">Description</label>
            <textarea v-model='desc' class="desc form__textarea grid__col--11" form="newpost"></textarea>
            <!--TODO: Pull list of categories from database-->
            <label class="form__label grid__col--1">Category</label>
            <select v-model='categorySelected' class="form__select grid__col--3">
                <option v-for='category in categories'>{{ category }}</option>
                <!--
                <option>Category 1</option>
                <option>Category 2</option>
                <option>Category 3</option>
                <option>Category 4</option>
                -->
            </select>
            <div class="grid__col--8"></div>
            <label for="price" class="form__label grid__col--1">Price</label>
            <input v-model='price' type="number" class="form__input--border grid__col--2">
            <button type="button" class="form__button--border grid__col--8">Cancel</button>
            <button v-on:click.prevent='sendData' type="submit" class="form__button--border grid__col--1">Post</button>
        </form>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="javascripts/SearchResults.js"></script>
<script>
    function checkInp(){
                var x=document.forms["myForm"]["age"].value;
                
                if (isNaN(x)){
                    alert("Must input numbers");
                    return false;
                }
    }

    var app = new Vue({
        el: '#app',
        data: {
            title: '',
            desc: '',
            categorySelected: 'Select Category',
            categories: ['Select Category','Electronics', 'Books', 'Furniture', 'Toys'],
            price: '',
            img: '',
        },

        

        methods: {
            
            sendData: function() {
                let id = Math.random() * 100;
                Math.round.ciel(id);

                axios.post(`localhost:3000/newpost/id:${id}`, formData = {
                    postTitle: app.title,
                    postDesc: app.desc,
                    postPrice: app.price,
                    postCat: app.categorySelected,
                })
                console.log(formData)
                .then(function(response){
                    console.log(response);
                })
                .catch(console.log(error));
            
                
        }
    }
        
    })
</script>
</html>